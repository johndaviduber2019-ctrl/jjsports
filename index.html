<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>J&J Sports</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

<style>
body{
margin:0;
font-family:Poppins;
background:#0f0f0f;
color:white;
}

header{
padding:20px;
font-size:22px;
font-weight:700;
color:#00ff88;
}

.container{padding:20px}

button{
width:100%;
padding:15px;
border:none;
border-radius:12px;
font-weight:600;
margin-bottom:10px;
}

.green{background:#00ff88;color:black}
.red{background:#ff4444;color:white}

.card{
background:#1a1a1a;
padding:15px;
border-radius:12px;
margin-bottom:15px;
}

.metric{
font-size:22px;
color:#00ff88;
}

.hiit-circle{
width:220px;
height:220px;
border-radius:50%;
border:8px solid #00ff88;
display:flex;
align-items:center;
justify-content:center;
flex-direction:column;
margin:20px auto;
font-size:28px;
transition:0.3s;
}

.rest{
border-color:#ff4444;
}

canvas{
background:#1a1a1a;
border-radius:12px;
padding:10px;
}
</style>
</head>

<body>

<header>J&J Sports</header>

<div class="container">

<h3>Corrida GPS</h3>

<button class="green" onclick="startRun()">Iniciar Corrida</button>
<button class="red" onclick="stopRun()">Finalizar Corrida</button>

<div class="card">
Dist√¢ncia
<div class="metric" id="distance">0.00 km</div>
</div>

<div class="card">
Tempo
<div class="metric" id="time">00:00</div>
</div>

<hr>

<h3>HIIT Personalizado</h3>

<input type="number" id="trainTime" placeholder="Tempo treino (segundos)" value="30" style="width:100%;padding:10px;border-radius:8px;margin-bottom:8px">

<input type="number" id="restTime" placeholder="Tempo descanso (segundos)" value="15" style="width:100%;padding:10px;border-radius:8px;margin-bottom:8px">

<input type="number" id="rounds" placeholder="N√∫mero de s√©ries" value="5" style="width:100%;padding:10px;border-radius:8px;margin-bottom:10px">

<button class="green" onclick="startHIIT()">Iniciar HIIT</button>
<button class="red" onclick="stopHIIT()">Finalizar HIIT</button>

<div class="hiit-circle" id="hiitCircle">
<div id="hiitMode">PRONTO</div>
<div id="hiitTimer">0</div>
<div id="hiitRound"></div>
</div>

  

<h3>Controle de Peso</h3>

<input type="number" id="weightInput" placeholder="Digite seu peso" style="width:100%;padding:10px;border-radius:8px;margin-bottom:10px">

<button class="green" onclick="saveWeight()">Salvar Peso</button>

<canvas id="weightChart"></canvas>

</div>

<script>

/* ===== CORRIDA ===== */

let watchId;
let startTime;
let timerInterval;
let totalDistance=0;
let lastPosition=null;

function startRun(){
totalDistance=0;
lastPosition=null;
startTime=Date.now();
timerInterval=setInterval(updateTime,1000);
watchId=navigator.geolocation.watchPosition(updatePosition);
}

function stopRun(){
clearInterval(timerInterval);
navigator.geolocation.clearWatch(watchId);
alert("Treino finalizado! Dist√¢ncia: "+(totalDistance/1000).toFixed(2)+" km");
}

function updateTime(){
let elapsed=Math.floor((Date.now()-startTime)/1000);
let m=String(Math.floor(elapsed/60)).padStart(2,'0');
let s=String(elapsed%60).padStart(2,'0');
document.getElementById("time").innerText=m+":"+s;
}

function updatePosition(position){
let lat=position.coords.latitude;
let lon=position.coords.longitude;

if(lastPosition!=null){
totalDistance+=calcDist(lastPosition.lat,lastPosition.lon,lat,lon);
}

lastPosition={lat,lon};

document.getElementById("distance").innerText=(totalDistance/1000).toFixed(2)+" km";
}

function calcDist(lat1,lon1,lat2,lon2){
const R=6371e3;
const œÜ1=lat1*Math.PI/180;
const œÜ2=lat2*Math.PI/180;
const ŒîœÜ=(lat2-lat1)*Math.PI/180;
const ŒîŒª=(lon2-lon1)*Math.PI/180;
const a=Math.sin(ŒîœÜ/2)**2+
Math.cos(œÜ1)*Math.cos(œÜ2)*Math.sin(ŒîŒª/2)**2;
const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));
return R*c;
}

/* ===== HIIT ===== */
let hiitInterval;
let hiitTime;
let training = true;
let currentRound = 1;
let totalRounds;

function startHIIT(){

clearInterval(hiitInterval);

let trainDuration = parseInt(document.getElementById("trainTime").value);
let restDuration = parseInt(document.getElementById("restTime").value);
totalRounds = parseInt(document.getElementById("rounds").value);

training = true;
currentRound = 1;
hiitTime = trainDuration;

updateHIITDisplay();

hiitInterval = setInterval(()=>{

hiitTime--;

if(hiitTime <= 0){

if(training){
training = false;
hiitTime = restDuration;
} else {
training = true;
currentRound++;

if(currentRound > totalRounds){
stopHIIT();
alert("HIIT Finalizado üí™üî•");
return;
}

hiitTime = trainDuration;
}

navigator.vibrate(300);
}

updateHIITDisplay();

},1000);
}

function stopHIIT(){
clearInterval(hiitInterval);
document.getElementById("hiitMode").innerText="FINALIZADO";
document.getElementById("hiitTimer").innerText="0";
document.getElementById("hiitRound").innerText="";
}

function updateHIITDisplay(){

document.getElementById("hiitTimer").innerText = hiitTime;
document.getElementById("hiitRound").innerText = "S√©rie " + currentRound + " / " + totalRounds;

if(training){
document.getElementById("hiitMode").innerText = "TREINO";
document.getElementById("hiitCircle").classList.remove("rest");
} else {
document.getElementById("hiitMode").innerText = "DESCANSO";
document.getElementById("hiitCircle").classList.add("rest");
}
}


/* ===== PESO ===== */

let weights=JSON.parse(localStorage.getItem("weights"))||[];

function saveWeight(){
let w=document.getElementById("weightInput").value;
if(w){
weights.push({date:new Date().toLocaleDateString(),value:w});
localStorage.setItem("weights",JSON.stringify(weights));
loadChart();
}
}

function loadChart(){
const ctx=document.getElementById('weightChart').getContext('2d');

new Chart(ctx,{
type:'line',
data:{
labels:weights.map(w=>w.date),
datasets:[{
label:'Peso',
data:weights.map(w=>w.value),
borderColor:'#00ff88',
tension:0.3
}]
}
});
}

loadChart();

</script>

</body>
</html>
